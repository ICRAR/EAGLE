<!DOCTYPE html> <!-- HTML5 document -->
<html lang="en">

<!--
{% include 'license.html' %}
//-->

    <head>
        <title id="tabTitle" data-bind="text: getTabTitle">EAGLE</title>

        <link rel="stylesheet" href="static/bootstrap.min.css">
        <link rel="stylesheet" href="static/base.css">
        <link rel="stylesheet" href="static/svg.css">
        <link rel="stylesheet" href="static/graph.css">
        <link rel="stylesheet" href="static/fonts.css">
        <link rel="stylesheet" href="static/introjs.min.css">

        <link rel="shortcut icon" href="static/assets/svg/liuFavIcon.svg" type="image/x-icon">

        <script src="static/externals/require.js"></script>
        <script src="static/built/require-config.js"></script>
        <script>
            require(["bootstrap"]);
            require(["bootstrap-notify"]);
            require(["introjs"]);
            require(["ajv"]);
            require(["bindingHandlers/readonly"]);
            require(["bindingHandlers/disabled"]);
            require(["bindingHandlers/graphRenderer"]);
            require(["bindingHandlers/nodeDataProperty"]);
            require(["components"]);
            require(["main"]);

            window.version = '{{version}}';
            window.commit_hash = '{{commit_hash}}';
            window.auto_load_service = '{{auto_load_service}}';
            window.auto_load_repository = '{{auto_load_repository}}';
            window.auto_load_branch = '{{auto_load_branch}}';
            window.auto_load_path = '{{auto_load_path}}';
            window.auto_load_filename = '{{auto_load_filename}}';
        </script>
    </head>

    <body>
        <!-- hidden area -->
        <div style="display:none;">
            <input id="uploadedGraphFileToLoad" class="fileSelector" type="file" name="file" data-bind="event: { change: uploadGraphFile }">
            <input id="uploadedGraphFileToInsert" class="fileSelector" type="file" name="file" data-bind="event: { change: insertGraphFile }">
            <input id="uploadedPaletteFileToLoad" class="fileSelector" type="file" name="file" data-bind="event: { change: uploadPaletteFile }">
        </div>

        {% include 'navbar.html' %}

        <div class="container-fluid" id="graphArea" data-bind="event: { dragover: sideWindowAdjust}">
            <div class="leftWindow" data-bind="style: { width: leftWindow().width(), left: leftWindow().shown() ? 0 : -leftWindow().width()}">
                <div class="leftWindowHandle" data-bind="click: leftWindow().toggleShown">
                    <span style="display: none" data-bind="visible: leftWindow().shown()">
                        <i class="material-icons">arrow_back</i>
                    </span>
                    <span data-bind="visible: !leftWindow().shown()">
                        <i class="material-icons">arrow_forward</i>
                    </span>
                </div>

                <div class="leftWindowDisplay palettes" data-bind="visible: leftWindow().mode() === Eagle.LeftWindowMode.Palettes">
                    {% include 'palettes.html' %}
                </div>

                <div class="leftWindowSizeAdjuster" draggable="true" data-bind="event: { dragstart: leftWindowAdjustStart , dragend: sideWindowAdjustEnd }">
                </div>
            </div>

            <div id="logicalGraphParent" data-bind="event: { dragover:nodeDragOver, drop: nodeDropLogicalGraph, mousemove: mouseMove, mousedown: function(){startDrag(null);}, mouseup: function(){endDrag(null);} }">
                <div id="logicalGraphD3Div">
                    <!-- ko if: $root.logicalGraph() !== null -->
                    <!-- ko foreach: $root.logicalGraph().getNodes() -->
                        {% include 'node.html' %}
                    <!-- /ko -->
                    <svg>
                        <!-- ko foreach: $root.logicalGraph().getEdges() -->
                        <path data-bind="attr:{d: $root.logicalGraph().getPath($data)}" stroke-width="2" fill="transparent" stroke="black" class=""></path>
                        <!-- /ko -->
                    </svg>
                    <!-- /ko -->
                </div>
            </div>

            <div class="rightWindow" data-bind="style: { width: rightWindow().width(), right: rightWindow().shown() ? 0 : -rightWindow().width()}">
               <div class="btn-group" id="rightWindowTabs" role="group" aria-label="RightWindowModeSelect">
                        <button class="btn btn-secondary navbar-btn" id="rightWindowModeRepositories" type="button" data-bind="click: function(){rightWindow().mode(Eagle.RightWindowMode.Repository);rightWindow().shown(true);}, css: {active: rightWindow().mode() === Eagle.RightWindowMode.Repository}" data-intro='Load palettes and graphs from remote git repositories.'>
                            Repositories
                        </button>
                        <button class="btn btn-secondary navbar-btn" id="rightWindowModeNode" type="button" data-bind="visible: selectedObjects().length > 0, click: function(){rightWindow().mode(Eagle.RightWindowMode.Inspector);rightWindow().shown(true);}, css: {active: rightWindow().mode() === Eagle.RightWindowMode.Inspector}">
                            Inspector
                        </button>
                        <button class="btn btn-secondary navbar-btn" id="rightWindowModeTranslation" type="button" data-bind="click: function(){rightWindow().mode(Eagle.RightWindowMode.TranslationMenu);rightWindow().shown(true);}, css: {active: rightWindow().mode() === Eagle.RightWindowMode.TranslationMenu}" data-intro='Submit a logical graph for translation into a physical graph.'>
                            Translation
                        </button>
                        <button class="btn btn-secondary navbar-btn" id="rightWindowModeHierarchy" type="button" data-bind="click: function(){rightWindow().mode(Eagle.RightWindowMode.Hierarchy);rightWindow().shown(true);}, css: {active: rightWindow().mode() === Eagle.RightWindowMode.Hierarchy}" data-intro='Explore the hierarchy of nodes in the current logical graph.'>
                            Hierarchy
                        </button>
                    </div>
                <div class="rightWindowHandle" data-bind="click: rightWindow().toggleShown">
                    <span data-bind="visible: rightWindow().shown()">
                        <i class="material-icons">arrow_forward</i>
                    </span>
                    <span style="display: none" data-bind="visible: !rightWindow().shown()">
                        <i class="material-icons">arrow_back</i>
                    </span>
                </div>
                <div id="rightWindowContainer">
                    <div class="rightWindowDisplay repository" data-bind="visible: rightWindow().mode() === Eagle.RightWindowMode.Repository">
                        {% include 'repositories.html' %}
                    </div>
                    <div data-bind="visible: rightWindow().mode() === Eagle.RightWindowMode.Inspector">
                        <div class="rightWindowDisplay nodeInspector" data-bind="visible: selectedNode() === null && selectedObjects().length > 1">
                            Select a single node or edge
                        </div>
                        <div class="rightWindowDisplay nodeInspector" data-bind="visible: selectedNode() !== null">
                            {% include 'node_inspector.html' %}
                        </div>
                        <div class="rightWindowDisplay edgeInspector" data-bind="visible: selectedEdge() !== null">
                            {% include 'edge_inspector.html' %}
                        </div>
                    </div>
                    <div class="rightWindowDisplay translationMenu" data-bind="visible: rightWindow().mode() === Eagle.RightWindowMode.TranslationMenu">
                        {% include 'translation_menu.html' %}
                    </div>
                    <div class="rightWindowDisplay hierarchy" data-bind="visible: rightWindow().mode() === Eagle.RightWindowMode.Hierarchy">
                        {% include 'hierarchy.html' %}
                    </div>
                </div>

                <div class="rightWindowSizeAdjuster" draggable="true" data-bind="event: { dragstart: rightWindowAdjustStart, dragend: sideWindowAdjustEnd }">
                </div>
            </div>
        </div>

        {% include 'modals.html' %}

        <span id="performance" data-bind="text: rendererFrameDisplay, visible: $root.showPerformanceDisplay"></span>
        <div id="htmlElementLog" style="display: none;"></div>
    </body>
</html>
